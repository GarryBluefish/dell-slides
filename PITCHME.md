---
marp: true
---

### Java Web Apps

---

### How the Web Works

-   browser sends request to server
-   server checks data in DB
-   server sends response to browser

---

## ![how-the-web-works](https://kroki.io/mermaid/svg/eNplzUEKwjAQheG9p3hroXSfRTdJVKS1YHKBsQ4S0LQmqV7fpCIuOsv_4zGRnzP7gZWjW6DHBvkmCskNbiKfIEER8u7Yp5WZYobDi8PKVDFFiS4UeVFZNY0R2GuLeo4c4lJNrkrA6FZLiy12577Dn1X1XZWCML5_o1ylwMF2bX00_QnX_OkDSOA75g==)

---

### Spring Framework

-   Framework for building apps in Java
-   Powerful ecosystem with many extensions/libraries

---

### Why use a Framework

-   follow established conventions
-   reusue existing code
-   speed up development

---

### Example

-   receive request/send response using `Spring Web Framework`
-   connect to `SQL Server` using `MSSQL Server Adapter`
-   interface with database using `JDBC/Hibernate`
-   generate HTML using `Thymeleaf`
-   interface with third party services via SDKs, e.g. `Paypal`

---

### Your First API

1. create your Spring Project
2. add a `PublicController`
3. create an endpoint that returns `Hello World` as text

```java
@RestController
public class PublicController {

    @GetMapping(value="/")
    public String index() {
        return "Hello World";
    }
}
```

---

## JSON Responses via String

```java
@GetMapping(value="/empty")
public String empty() {
    return "{}";
}

@GetMapping(value="/users")
public String users() {
    return "[{\"id\": 12, \"name\": \"Ming Xiang\"}]";
}
```

---

## JSON Responses via Class

```java
class User {
    int id;
    String name;

    // getters are required for JSON conversion
    // usually autogenerated
    int getId() { return this.id; }
    int getName() { return this.name; }
}
```

---

## JSON Responses via Class

```java
@GetMapping(value="/user")
public User user() {
    User user = new User();
    user.id = 12;
    user.name = "Ming Xiang";
    return user;
}

// must differentiate single user object and array of users
@GetMapping(value="/users")
public User[] users() {
    User user = new User();
    user.id = 12;
    user.name = "Ming Xiang";
    User[] users = { user };
    return users;
}
```

---

# Exercise

-   `UserController`
    -   `/user/` -> get single user
    -   `/users/` -> get multiple users
-   `PropertyController`
    -   `/property/` -> get single property
    -   `/properties/` -> get multiple properties
-   `BookingController`
    -   `/booking/` -> get single booking
    -   `/bookings/` -> get multiple bookings

---

# Receiving input

-   search criteria for a list of users
-   form data from a signup form
-   only display data for a single user

---

# How to receive input

-   path variables
    `/users/{id}`

-   query parameters
    `/users?name=mingiangchan`

-   json request body
    ```json
    {
        "name": "Ming Xiang Chan"
    }
    ```

---

# Path Variables

### Url

-   `/users/ming_xiang`
-   `/users/ming_hao`

### Code

```java
@GetMapping(path="/user/{name}")
public String user(@PathVariable("name") String name) {
    model.addAttribute("name", name);
    return "user";
}
```

---

# Exercise

-   `UserController`
    -   `/user/{name}`
    -   change `name` of returned `User` object
-   `PropertyController`
    -   `/property/{id}`
    -   change `id` of returned `Property` object
-   `BookingController`
    -   `/booking/{confirmed}`
    -   change `confirmed` of returned `Booking` object

---

# Query Parameters

### Url

-   `/users/?name=ming_xiang`
-   `/users/?name=ming_hao&age=28`

### Code

```java
@GetMapping(path="/users")
public String users(@RequestParam(name = "age") int age) {
    model.addAttribute("age", age);
    return "users";
}
```

---

# Exercise

-   `UserController`
    -   `/users?name=mingxiangchan`
    -   only return `User` with matching `name` in the `User[]`
-   `PropertyController`
    -   `/property?location=KL`
    -   only return `Property` with matching `location` in the `Property[]`
-   `BookingController`
    -   `/booking?confirmed=true`
    -   only return `Booking` with matching `confirmed` in the `Booking[]`

---

# Request Body

### Code

```java
@PostMapping(path="/create_user")
public String createUser(@RequestBody User user) {
    return user;
}
```

---

### HTTP Methods

-   GET
-   POST
-   PUT
-   PATCH

---

# Exercise

-   `UserController`
    -   `/update_user`
-   `PropertyController`
    -   `/create_property`
-   `BookingController`
    -   `/create_booking`

---

# How to document your API endpoints

-   HTTP method
-   url
-   any query params
-   any path params
-   any request JSON body
-   what is the response JSON body

Try it out with [Stoplight.io](https://stoplight.io/p/studio)
